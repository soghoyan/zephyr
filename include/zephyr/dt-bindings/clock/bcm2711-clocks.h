/*
 * Copyright (c) 2023 Chen Xingyu <hi@xingrz.me>
 * SPDX-License-Identifier: Apache-2.0
 */

#ifndef ZEPHYR_DT_BCM2711_CLOCKS_H_
#define ZEPHYR_DT_BCM2711_CLOCKS_H_

#define BCM2711_CLOCK_CONFIG_INDEX_S (0)
#define BCM2711_CLOCK_CONFIG_INDEX_M (0xff)
#define BCM2711_CLOCK_CONFIG_INDEX(config)                                                         \
	((config >> BCM2711_CLOCK_CONFIG_INDEX_S) & BCM2711_CLOCK_CONFIG_INDEX_M)

#define BCM2711_CLOCK_CONFIG_INT_BITS_S (8)
#define BCM2711_CLOCK_CONFIG_INT_BITS_M (0xff)
#define BCM2711_CLOCK_CONFIG_INT_BITS(config)                                                      \
	((config >> BCM2711_CLOCK_CONFIG_INT_BITS_S) & BCM2711_CLOCK_CONFIG_INT_BITS_M)

#define BCM2711_CLOCK_CONFIG_FRAC_BITS_S (16)
#define BCM2711_CLOCK_CONFIG_FRAC_BITS_M (0xff)
#define BCM2711_CLOCK_CONFIG_FRAC_BITS(config)                                                     \
	((config >> BCM2711_CLOCK_CONFIG_FRAC_BITS_S) & BCM2711_CLOCK_CONFIG_FRAC_BITS_M)

#define BCM2711_CLOCK_CONFIG(index, int_bits, frac_bits)                                           \
	(((index & BCM2711_CLOCK_CONFIG_INDEX_M) << BCM2711_CLOCK_CONFIG_INDEX_S) |                \
	 ((int_bits & BCM2711_CLOCK_CONFIG_INT_BITS_M) << BCM2711_CLOCK_CONFIG_INT_BITS_S) |       \
	 ((frac_bits & BCM2711_CLOCK_CONFIG_FRAC_BITS_M) << BCM2711_CLOCK_CONFIG_FRAC_BITS_S))

#define BCM2711_CLOCK_VPU   BCM2711_CLOCK_CONFIG(1, 12, 8)
#define BCM2711_CLOCK_H264  BCM2711_CLOCK_CONFIG(5, 4, 8)
#define BCM2711_CLOCK_ISP   BCM2711_CLOCK_CONFIG(6, 4, 8)
#define BCM2711_CLOCK_CAM0  BCM2711_CLOCK_CONFIG(8, 4, 8)
#define BCM2711_CLOCK_CAM1  BCM2711_CLOCK_CONFIG(9, 4, 8)
#define BCM2711_CLOCK_DSI0E BCM2711_CLOCK_CONFIG(11, 4, 8)
#define BCM2711_CLOCK_DSI0P BCM2711_CLOCK_CONFIG(12, 0, 0)
#define BCM2711_CLOCK_DPI   BCM2711_CLOCK_CONFIG(13, 4, 8)
#define BCM2711_CLOCK_GP0   BCM2711_CLOCK_CONFIG(14, 12, 12)
#define BCM2711_CLOCK_GP1   BCM2711_CLOCK_CONFIG(15, 12, 12)
#define BCM2711_CLOCK_GP2   BCM2711_CLOCK_CONFIG(16, 12, 12)
#define BCM2711_CLOCK_HSM   BCM2711_CLOCK_CONFIG(17, 4, 8)
#define BCM2711_CLOCK_OTP   BCM2711_CLOCK_CONFIG(18, 4, 0)
#define BCM2711_CLOCK_PCM   BCM2711_CLOCK_CONFIG(19, 12, 12)
#define BCM2711_CLOCK_PWM   BCM2711_CLOCK_CONFIG(20, 12, 12)
#define BCM2711_CLOCK_SLIM  BCM2711_CLOCK_CONFIG(21, 12, 12)
#define BCM2711_CLOCK_SMI   BCM2711_CLOCK_CONFIG(22, 4, 8)
#define BCM2711_CLOCK_TEC   BCM2711_CLOCK_CONFIG(25, 6, 0)
#define BCM2711_CLOCK_TSENS BCM2711_CLOCK_CONFIG(28, 5, 0)
#define BCM2711_CLOCK_TIMER BCM2711_CLOCK_CONFIG(29, 6, 12)
#define BCM2711_CLOCK_UART  BCM2711_CLOCK_CONFIG(30, 10, 12)
#define BCM2711_CLOCK_SDRAM BCM2711_CLOCK_CONFIG(53, 6, 0)
#define BCM2711_CLOCK_AVEO  BCM2711_CLOCK_CONFIG(55, 4, 0)
#define BCM2711_CLOCK_EMMC  BCM2711_CLOCK_CONFIG(56, 4, 8)
#define BCM2711_CLOCK_EMMC2 BCM2711_CLOCK_CONFIG(58, 4, 8)

#endif /* ZEPHYR_DT_BCM2711_CLOCKS_H_ */
